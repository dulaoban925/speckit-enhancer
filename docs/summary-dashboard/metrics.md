# Feature Dashboard ç»Ÿè®¡æŒ‡æ ‡è¯¦ç»†è¯´æ˜

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº† Feature Dashboard ä¸­æ‰€æœ‰ç»Ÿè®¡æŒ‡æ ‡çš„å«ä¹‰ã€è®¡ç®—é€»è¾‘å’Œæ•°æ®æ¥æºã€‚

---

## ğŸ“š ç›®å½•

- [æ¶æ„æ¦‚è§ˆ](#-æ¶æ„æ¦‚è§ˆ)
- [1. è¿›åº¦æŒ‡æ ‡ (Progress Metrics)](#1-è¿›åº¦æŒ‡æ ‡-progress-metrics)
- [2. æ–‡æ¡£å¥åº·åº¦æŒ‡æ ‡ (Document Metrics)](#2-æ–‡æ¡£å¥åº·åº¦æŒ‡æ ‡-document-metrics)
- [3. ç”¨æˆ·æ•…äº‹æŒ‡æ ‡ (User Story Metrics)](#3-ç”¨æˆ·æ•…äº‹æŒ‡æ ‡-user-story-metrics)
- [4. åä½œæ´»è·ƒåº¦æŒ‡æ ‡ (Collaboration Metrics)](#4-åä½œæ´»è·ƒåº¦æŒ‡æ ‡-collaboration-metrics)
- [5. é£é™©æŒ‡æ ‡ (Risk Metrics)](#5-é£é™©æŒ‡æ ‡-risk-metrics)
- [æ•°æ®æµç¨‹å’Œé›†æˆ](#-æ•°æ®æµç¨‹å’Œé›†æˆ)
- [ä½¿ç”¨æŒ‡å—](#-ä½¿ç”¨æŒ‡å—)

---

## ğŸ— æ¶æ„æ¦‚è§ˆ

### æ•°æ®æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Feature Dashboard                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  useDashboardData Hook      â”‚  ä¸»æ•°æ®èšåˆå±‚
         â”‚  - åè°ƒæ‰€æœ‰æ•°æ®åŠ è½½         â”‚
         â”‚  - ç¼“å­˜ç®¡ç† (5åˆ†é’Ÿ TTL)     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼        â–¼        â–¼          â–¼           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Tasks   â”‚ â”‚ Spec   â”‚ â”‚Commentsâ”‚ â”‚Documentsâ”‚ â”‚ Risks  â”‚
    â”‚ Parser  â”‚ â”‚ Parser â”‚ â”‚ Parser â”‚ â”‚ Metrics â”‚ â”‚Metrics â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚          â”‚           â”‚           â”‚          â”‚
         â–¼          â–¼           â–¼           â–¼          â–¼
    tasks.md    spec.md    .specify/    Core Docs   Aggregated
                           memory/                   Data
                           comments/
```

### æ ¸å¿ƒæ–‡ä»¶

| æ–‡ä»¶è·¯å¾„ | ä½œç”¨ | å…³é”®å‡½æ•° |
|---------|------|---------|
| `hooks/useDashboardData.ts` | ä¸»æ•°æ®èšåˆå±‚ | `loadDashboardData()` |
| `parsers/tasksParser.ts` | è§£æä»»åŠ¡æ–‡ä»¶ | `parseTasksFile()` |
| `parsers/specParser.ts` | è§£æè§„æ ¼æ–‡ä»¶ | `parseSpecFile()` |
| `parsers/commentsParser.ts` | è§£æè¯„è®ºæ•°æ® | `parseCommentsData()` |
| `services/metrics/documentMetrics.ts` | æ–‡æ¡£å¥åº·åº¦è®¡ç®— | `calculateDocumentMetrics()` |
| `services/metrics/riskMetrics.ts` | é£é™©æŒ‡æ ‡è®¡ç®— | `calculateRiskMetrics()` |
| `types/metrics.ts` | ç±»å‹å®šä¹‰ | æ‰€æœ‰ Metrics æ¥å£ |

---

## 1. è¿›åº¦æŒ‡æ ‡ (Progress Metrics)

### ğŸ“Š æŒ‡æ ‡è¯´æ˜

è¿›åº¦æŒ‡æ ‡åæ˜ ç‰¹æ€§å¼€å‘çš„æ•´ä½“å®Œæˆæƒ…å†µï¼ŒåŸºäºä»»åŠ¡åˆ—è¡¨è®¡ç®—ã€‚

### ğŸ¯ æŒ‡æ ‡åˆ—è¡¨

#### 1.1 æ€»ä»»åŠ¡æ•° (totalTasks)

- **å«ä¹‰**: ç‰¹æ€§ä¸­æ‰€æœ‰ä»»åŠ¡çš„æ€»æ•°
- **æ•°æ®æ¥æº**: `tasks.md` æ–‡ä»¶
- **è®¡ç®—é€»è¾‘**: ç»Ÿè®¡æ‰€æœ‰ä»»åŠ¡è¡Œï¼ˆåŒ…æ‹¬å·²å®Œæˆã€è¿›è¡Œä¸­ã€å¾…åŠã€é˜»å¡ï¼‰
- **Markdown æ ¼å¼**:
  ```markdown
  - [ ] å¾…åŠä»»åŠ¡
  - [x] å·²å®Œæˆä»»åŠ¡
  ```
- **ä»£ç ä½ç½®**: `parsers/tasksParser.ts:17-35`

#### 1.2 å·²å®Œæˆä»»åŠ¡æ•° (completedTasks)

- **å«ä¹‰**: å·²æ ‡è®°ä¸ºå®Œæˆçš„ä»»åŠ¡æ•°é‡
- **æ•°æ®æ¥æº**: `tasks.md` æ–‡ä»¶
- **è®¡ç®—é€»è¾‘**: ç»Ÿè®¡æ‰€æœ‰ `[x]` æˆ– `[X]` æ ‡è®°çš„ä»»åŠ¡
- **æ­£åˆ™è¡¨è¾¾å¼**: `/^-\s+\[([xX])\]\s+(.+)/`
- **ä»£ç ä½ç½®**: `parsers/tasksParser.ts:25`

#### 1.3 è¿›è¡Œä¸­ä»»åŠ¡æ•° (inProgressTasks)

- **å«ä¹‰**: æ­£åœ¨è¿›è¡Œä¸­ä½†æœªå®Œæˆçš„ä»»åŠ¡
- **æ•°æ®æ¥æº**: `tasks.md` æ–‡ä»¶
- **è®¡ç®—é€»è¾‘**: å½“å‰æš‚æ— æ˜ç¡®æ ‡è®°ï¼Œé»˜è®¤ä¸º 0ï¼ˆæœªæ¥å¯æ‰©å±•ï¼‰
- **å¤‡æ³¨**: å¯é€šè¿‡ä»»åŠ¡æè¿°ä¸­çš„å…³é”®è¯ï¼ˆå¦‚ "è¿›è¡Œä¸­", "in progress"ï¼‰è¯†åˆ«

#### 1.4 å¾…åŠä»»åŠ¡æ•° (pendingTasks)

- **å«ä¹‰**: å°šæœªå¼€å§‹çš„ä»»åŠ¡
- **æ•°æ®æ¥æº**: `tasks.md` æ–‡ä»¶
- **è®¡ç®—é€»è¾‘**: ç»Ÿè®¡æ‰€æœ‰ `[ ]` æ ‡è®°çš„ä»»åŠ¡
- **æ­£åˆ™è¡¨è¾¾å¼**: `/^-\s+\[([ ])\]\s+(.+)/`

#### 1.5 é˜»å¡ä»»åŠ¡æ•° (blockedTasks)

- **å«ä¹‰**: å› ä¾èµ–æˆ–é—®é¢˜è€Œè¢«é˜»å¡çš„ä»»åŠ¡
- **æ•°æ®æ¥æº**: `tasks.md` æ–‡ä»¶
- **è®¡ç®—é€»è¾‘**: å½“å‰é»˜è®¤ä¸º 0ï¼ˆæœªæ¥å¯é€šè¿‡å…³é”®è¯æˆ–æ ‡ç­¾è¯†åˆ«ï¼‰
- **å¯èƒ½æ ‡è®°**: ä»»åŠ¡æè¿°åŒ…å« "é˜»å¡", "blocked", "ä¾èµ–"

#### 1.6 å®Œæˆç™¾åˆ†æ¯” (percentage)

- **å«ä¹‰**: é¡¹ç›®æ•´ä½“å®Œæˆè¿›åº¦
- **è®¡ç®—å…¬å¼**:
  ```typescript
  percentage = (completedTasks / totalTasks) * 100
  ```
- **å–å€¼èŒƒå›´**: 0-100
- **ç¤ºä¾‹**:
  - 30/100 ä»»åŠ¡å®Œæˆ â†’ 30%
  - 0/50 ä»»åŠ¡å®Œæˆ â†’ 0%
  - 50/50 ä»»åŠ¡å®Œæˆ â†’ 100%

#### 1.7 å½“å‰é˜¶æ®µ (currentPhase)

- **å«ä¹‰**: å½“å‰å¼€å‘æ‰€å¤„çš„é˜¶æ®µåç§°
- **æ•°æ®æ¥æº**: `tasks.md` æ–‡ä»¶ä¸­çš„é˜¶æ®µæ ‡é¢˜
- **Markdown æ ¼å¼**:
  ```markdown
  ## Phase 1: åŸºç¡€æ¶æ„æ­å»º
  ## Phase 2: æ ¸å¿ƒåŠŸèƒ½å¼€å‘
  ```
- **æ­£åˆ™è¡¨è¾¾å¼**: `/^##\s+Phase\s+\d+:\s+(.+)/`
- **é€»è¾‘**: æœ€åä¸€ä¸ªåŒ…å«æœªå®Œæˆä»»åŠ¡çš„é˜¶æ®µ
- **ä»£ç ä½ç½®**: `parsers/tasksParser.ts:37-43`

#### 1.8 é¢„ä¼°å‰©ä½™ä»»åŠ¡æ•° (estimatedRemaining)

- **å«ä¹‰**: è¿˜éœ€è¦å®Œæˆçš„ä»»åŠ¡æ•°é‡
- **è®¡ç®—å…¬å¼**:
  ```typescript
  estimatedRemaining = totalTasks - completedTasks
  ```

#### 1.9 é¡¹ç›®çŠ¶æ€ (status)

- **å«ä¹‰**: é¡¹ç›®å½“å‰çŠ¶æ€
- **å–å€¼**:
  - `'not-started'`: å°šæœªå¼€å§‹ï¼ˆ0% å®Œæˆï¼‰
  - `'active'`: è¿›è¡Œä¸­ï¼ˆ1%-99% å®Œæˆï¼‰
  - `'completed'`: å·²å®Œæˆï¼ˆ100% å®Œæˆï¼‰
- **è®¡ç®—é€»è¾‘**:
  ```typescript
  if (percentage === 0) return 'not-started'
  if (percentage === 100) return 'completed'
  return 'active'
  ```
- **ä»£ç ä½ç½®**: `hooks/useDashboardData.ts:264-269`

---

## 2. æ–‡æ¡£å¥åº·åº¦æŒ‡æ ‡ (Document Metrics)

### ğŸ“Š æŒ‡æ ‡è¯´æ˜

æ–‡æ¡£å¥åº·åº¦æŒ‡æ ‡åæ˜ é¡¹ç›®æ–‡æ¡£çš„å®Œæ•´æ€§å’Œæ—¶æ•ˆæ€§ï¼Œå¸®åŠ©è¯†åˆ«æ–‡æ¡£ç¼ºå¤±æˆ–è¿‡æ—¶çš„æƒ…å†µã€‚

### ğŸ¯ æŒ‡æ ‡åˆ—è¡¨

#### 2.1 æ–‡æ¡£è¦†ç›–ç‡ (coverage)

- **å«ä¹‰**: æ ¸å¿ƒæ–‡æ¡£çš„å®Œæ•´ç¨‹åº¦
- **æ•°æ®æ¥æº**: `specs/[feature-id]/` ç›®å½•ä¸‹çš„æ ¸å¿ƒæ–‡æ¡£
- **æ ¸å¿ƒæ–‡æ¡£åˆ—è¡¨**:
  1. `spec.md` - åŠŸèƒ½è§„æ ¼è¯´æ˜
  2. `plan.md` - å®æ–½è®¡åˆ’
  3. `tasks.md` - ä»»åŠ¡åˆ—è¡¨
  4. `research.md` - æŠ€æœ¯ç ”ç©¶
  5. `data-model.md` - æ•°æ®æ¨¡å‹
  6. `quickstart.md` - å¿«é€Ÿå…¥é—¨
- **è®¡ç®—å…¬å¼**:
  ```typescript
  coverage = (existingDocs.length / totalCoreDocuments) * 100
  ```
- **æœ‰æ•ˆæ–‡æ¡£å®šä¹‰**: æ–‡ä»¶å­˜åœ¨ä¸”å¤§å° >= 100 å­—èŠ‚
- **ç¤ºä¾‹**: 6 ä¸ªæ ¸å¿ƒæ–‡æ¡£ä¸­æœ‰ 5 ä¸ªå­˜åœ¨ â†’ 83.33%
- **ä»£ç ä½ç½®**: `hooks/useDashboardData.ts:102-163`

#### 2.2 æ–‡æ¡£åˆ—è¡¨ (documents)

- **å«ä¹‰**: æ¯ä¸ªæ ¸å¿ƒæ–‡æ¡£çš„è¯¦ç»†çŠ¶æ€
- **åŒ…å«ä¿¡æ¯**:
  - `name`: æ–‡æ¡£åç§°
  - `path`: æ–‡æ¡£è·¯å¾„
  - `exists`: æ˜¯å¦å­˜åœ¨
  - `size`: æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰
  - `lastModified`: æœ€åä¿®æ”¹æ—¶é—´
  - `status`: æ–‡æ¡£çŠ¶æ€ï¼ˆè§ä¸‹ï¼‰
- **ä»£ç ä½ç½®**: `hooks/useDashboardData.ts:273-280`

#### 2.3 æ–‡æ¡£çŠ¶æ€ (status)

- **å«ä¹‰**: å•ä¸ªæ–‡æ¡£çš„å¥åº·çŠ¶æ€
- **å–å€¼**:
  - `'ok'`: å¥åº· - æ–‡ä»¶å­˜åœ¨ï¼Œå¤§å° >= 100 å­—èŠ‚ï¼Œ30 å¤©å†…æ›´æ–°
  - `'missing'`: ç¼ºå¤± - æ–‡ä»¶ä¸å­˜åœ¨æˆ–å¤§å° < 100 å­—èŠ‚
  - `'stale'`: è¿‡æ—¶ - æ–‡ä»¶å­˜åœ¨ä¸”å¤§å° >= 100ï¼Œä½†è¶…è¿‡ 30 å¤©æœªæ›´æ–°
- **åˆ¤æ–­é€»è¾‘**:
  ```typescript
  if (!exists || size < 100) return 'missing'
  if (daysSinceModified > 30) return 'stale'
  return 'ok'
  ```
- **ä»£ç ä½ç½®**:
  - `services/metrics/documentMetrics.ts:61-68`
  - `hooks/useDashboardData.ts:141`

#### 2.4 å¹³å‡æ›´æ–°æ—¶é•¿ (averageUpdateAge)

- **å«ä¹‰**: æ‰€æœ‰æœ‰æ•ˆæ–‡æ¡£çš„å¹³å‡æœªæ›´æ–°å¤©æ•°
- **æ•°æ®æ¥æº**: å„æ–‡æ¡£çš„ `lastModified` æ—¶é—´æˆ³
- **è®¡ç®—å…¬å¼**:
  ```typescript
  ageInDays = (Date.now() - lastModified.getTime()) / (1000 * 60 * 60 * 24)
  averageUpdateAge = sum(ageInDays) / existingDocs.length
  ```
- **å•ä½**: å¤©ï¼ˆå‘ä¸‹å–æ•´ï¼‰
- **ç¤ºä¾‹**:
  - spec.md: 5 å¤©å‰
  - plan.md: 15 å¤©å‰
  - tasks.md: 2 å¤©å‰
  - å¹³å‡: (5 + 15 + 2) / 3 = 7.33 å¤©
- **è§£è¯»**:
  - < 7 å¤©: æ–‡æ¡£ä¿æŒé¢‘ç¹æ›´æ–°
  - 7-30 å¤©: æ–‡æ¡£æ›´æ–°é€‚åº¦
  - > 30 å¤©: æ–‡æ¡£å¯èƒ½éœ€è¦ç»´æŠ¤
- **ä»£ç ä½ç½®**: `hooks/useDashboardData.ts:161-163`

---

## 3. ç”¨æˆ·æ•…äº‹æŒ‡æ ‡ (User Story Metrics)

### ğŸ“Š æŒ‡æ ‡è¯´æ˜

ç”¨æˆ·æ•…äº‹æŒ‡æ ‡åæ˜ åŠŸèƒ½éœ€æ±‚çš„å®Œæˆæƒ…å†µï¼ŒæŒ‰ä¼˜å…ˆçº§åˆ†ç»„è·Ÿè¸ªã€‚

### ğŸ¯ æŒ‡æ ‡åˆ—è¡¨

#### 3.1 æ€»ç”¨æˆ·æ•…äº‹æ•° (total)

- **å«ä¹‰**: ç‰¹æ€§ä¸­å®šä¹‰çš„æ‰€æœ‰ç”¨æˆ·æ•…äº‹æ•°é‡
- **æ•°æ®æ¥æº**: `spec.md` æ–‡ä»¶
- **Markdown æ ¼å¼**:
  ```markdown
  ### User Story 1 - ç”¨æˆ·æ•…äº‹æ ‡é¢˜ (Priority: P1)
  ### User Story 2 - å¦ä¸€ä¸ªæ•…äº‹ (Priority: P2)
  ```
- **æ­£åˆ™è¡¨è¾¾å¼**: `/^###\s+User Story\s+(\d+)\s+-\s+(.+?)\s+\(Priority:\s+(P[1-3])\)/`
- **ä»£ç ä½ç½®**: `parsers/specParser.ts:17-25`

#### 3.2 æŒ‰ä¼˜å…ˆçº§åˆ†ç»„ (byPriority)

- **å«ä¹‰**: æŒ‰ P1ã€P2ã€P3 ä¼˜å…ˆçº§åˆ†ç»„çš„ç”¨æˆ·æ•…äº‹ç»Ÿè®¡
- **ä¼˜å…ˆçº§å®šä¹‰**:
  - **P1**: é«˜ä¼˜å…ˆçº§ - æ ¸å¿ƒåŠŸèƒ½ï¼Œå¿…é¡»å®ç°
  - **P2**: ä¸­ä¼˜å…ˆçº§ - é‡è¦åŠŸèƒ½ï¼Œåº”è¯¥å®ç°
  - **P3**: ä½ä¼˜å…ˆçº§ - å¢å¼ºåŠŸèƒ½ï¼Œå¯é€‰å®ç°
- **æ¯ç»„åŒ…å«**:
  - `total`: è¯¥ä¼˜å…ˆçº§çš„æ•…äº‹æ€»æ•°
  - `completed`: å·²å®Œæˆçš„æ•…äº‹æ•°
  - `percentage`: å®Œæˆç™¾åˆ†æ¯”
  - `stories`: æ•…äº‹åˆ—è¡¨è¯¦æƒ…
- **è®¡ç®—å…¬å¼**:
  ```typescript
  percentage = (completed / total) * 100
  ```
- **ä»£ç ä½ç½®**: `hooks/useDashboardData.ts:172-190`

#### 3.3 éªŒæ”¶åœºæ™¯ç»Ÿè®¡ (acceptanceScenarios)

- **å«ä¹‰**: ç”¨æˆ·æ•…äº‹çš„éªŒæ”¶æ ‡å‡†å®Œæˆæƒ…å†µ
- **æ•°æ®æ¥æº**: `spec.md` ä¸­æ¯ä¸ªç”¨æˆ·æ•…äº‹çš„éªŒæ”¶åœºæ™¯ç« èŠ‚
- **Markdown æ ¼å¼**:
  ```markdown
  #### Acceptance Scenarios

  1. åœºæ™¯æè¿° 1
  2. åœºæ™¯æè¿° 2
  3. åœºæ™¯æè¿° 3
  ```
- **åŒ…å«æŒ‡æ ‡**:
  - `passed`: å·²é€šè¿‡çš„åœºæ™¯æ•°
  - `total`: æ€»åœºæ™¯æ•°
  - `passRate`: é€šè¿‡ç‡ç™¾åˆ†æ¯”
- **è®¡ç®—é€»è¾‘**ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼‰:
  ```typescript
  // å¦‚æœç”¨æˆ·æ•…äº‹æ ‡è®°ä¸ºå®Œæˆï¼Œåˆ™å…¶æ‰€æœ‰éªŒæ”¶åœºæ™¯é€šè¿‡
  passedScenarios = userStories
    .filter(story => story.isCompleted)
    .reduce((sum, story) => sum + story.acceptanceScenarios, 0)

  passRate = (passedScenarios / totalScenarios) * 100
  ```
- **ä»£ç ä½ç½®**:
  - åœºæ™¯è§£æ: `parsers/specParser.ts:38-43`
  - é€šè¿‡ç‡è®¡ç®—: `hooks/useDashboardData.ts:193-199`
- **å¤‡æ³¨**: å½“å‰ä¸ºç®€åŒ–é€»è¾‘ï¼Œæœªæ¥å¯é€šè¿‡æµ‹è¯•æ¡†æ¶é›†æˆå®é™…æµ‹è¯•ç»“æœ

---

## 4. åä½œæ´»è·ƒåº¦æŒ‡æ ‡ (Collaboration Metrics)

### ğŸ“Š æŒ‡æ ‡è¯´æ˜

åä½œæŒ‡æ ‡åæ˜ å›¢é˜Ÿåœ¨æ–‡æ¡£ä¸Šçš„è®¨è®ºæ´»è·ƒåº¦å’Œå“åº”æ•ˆç‡ã€‚

### ğŸ¯ æŒ‡æ ‡åˆ—è¡¨

#### 4.1 æ€»è¯„è®ºæ•° (totalComments)

- **å«ä¹‰**: æ‰€æœ‰æ–‡æ¡£çš„è¯„è®ºæ€»æ•°ï¼ˆåŒ…æ‹¬å›å¤ï¼‰
- **æ•°æ®æ¥æº**: `.specify/memory/comments/[feature-id]/` ç›®å½•ä¸‹çš„æ‰€æœ‰è¯„è®ºæ–‡ä»¶
- **è®¡ç®—é€»è¾‘**: æ‰å¹³åŒ–æ‰€æœ‰è¯„è®ºï¼ˆé€’å½’åŒ…å«æ‰€æœ‰å›å¤ï¼‰
- **ä»£ç ä½ç½®**: `parsers/commentsParser.ts:33-53`

#### 4.2 æœ¬å‘¨æ–°å¢è¯„è®º (newThisWeek)

- **å«ä¹‰**: æœ€è¿‘ 7 å¤©å†…åˆ›å»ºçš„è¯„è®ºæ•°é‡
- **è®¡ç®—é€»è¾‘**:
  ```typescript
  const oneWeekAgo = new Date()
  oneWeekAgo.setDate(oneWeekAgo.getDate() - 7)

  newThisWeek = comments.filter(
    comment => new Date(comment.createdAt) > oneWeekAgo
  ).length
  ```
- **ä»£ç ä½ç½®**: `parsers/commentsParser.ts:58-64`

#### 4.3 å‘¨å¢é•¿ç‡ (weeklyGrowth)

- **å«ä¹‰**: è¯„è®ºæ´»è·ƒåº¦çš„å‘¨ç¯æ¯”å¢é•¿
- **è®¡ç®—å…¬å¼**:
  ```typescript
  // ä¸Šå‘¨æ–°å¢è¯„è®ºï¼ˆ7-14 å¤©å‰ï¼‰
  newLastWeek = comments.filter(comment =>
    createdAt > twoWeeksAgo && createdAt <= oneWeekAgo
  ).length

  // å¢é•¿ç‡
  if (newLastWeek > 0) {
    weeklyGrowth = ((newThisWeek - newLastWeek) / newLastWeek) * 100
  } else if (newThisWeek > 0) {
    weeklyGrowth = 100  // ä» 0 å¼€å§‹æœ‰è¯„è®ºï¼Œ100% å¢é•¿
  } else {
    weeklyGrowth = 0
  }
  ```
- **è§£è¯»**:
  - > 0: è¯„è®ºæ´»è·ƒåº¦ä¸Šå‡
  - = 0: è¯„è®ºæ´»è·ƒåº¦æŒå¹³
  - < 0: è¯„è®ºæ´»è·ƒåº¦ä¸‹é™
- **ä»£ç ä½ç½®**: `parsers/commentsParser.ts:66-83`

#### 4.4 æœªè§£å†³é—®é¢˜ (unresolvedIssues)

- **å«ä¹‰**: çŠ¶æ€ä¸º 'open' çš„è¯„è®ºæ•°é‡
- **è®¡ç®—é€»è¾‘**:
  ```typescript
  unresolvedIssues = comments.filter(
    comment => comment.status === 'open'
  ).length
  ```
- **ä»£ç ä½ç½®**: `parsers/commentsParser.ts:86`

#### 4.5 é˜»å¡é—®é¢˜ (blockingIssues)

- **å«ä¹‰**: æ ‡è®°ä¸ºé˜»å¡æˆ–åŒ…å«ç´§æ€¥å…³é”®è¯çš„å¼€æ”¾è¯„è®º
- **å…³é”®è¯åˆ—è¡¨**: `['é˜»å¡', 'blocked', 'urgent', 'ç´§æ€¥', 'critical']`
- **è®¡ç®—é€»è¾‘**:
  ```typescript
  blockingIssues = comments.filter(comment =>
    comment.status === 'open' &&
    blockingKeywords.some(keyword =>
      comment.content.toLowerCase().includes(keyword)
    )
  ).length
  ```
- **ä»£ç ä½ç½®**: `parsers/commentsParser.ts:88-94`

#### 4.6 å‚ä¸äººæ•° (participantCount)

- **å«ä¹‰**: å‚ä¸è¯„è®ºçš„ä¸é‡å¤ä½œè€…æ•°é‡
- **è®¡ç®—é€»è¾‘**:
  ```typescript
  const participants = new Set(
    comments.map(comment => comment.author)
  )
  participantCount = participants.size
  ```
- **ä»£ç ä½ç½®**: `parsers/commentsParser.ts:96-98`

#### 4.7 Top è´¡çŒ®è€… (topContributors)

- **å«ä¹‰**: è¯„è®ºæ•°æœ€å¤šçš„å‰ 5 ä½è´¡çŒ®è€…
- **åŒ…å«ä¿¡æ¯**:
  - `author`: ä½œè€…åç§°
  - `commentCount`: è¯„è®ºæ•°é‡
  - `lastActive`: æœ€åæ´»è·ƒæ—¶é—´
- **è®¡ç®—é€»è¾‘**:
  ```typescript
  // 1. ç»Ÿè®¡æ¯ä¸ªä½œè€…çš„è¯„è®ºæ•°
  authorCounts[author] = (authorCounts[author] || 0) + 1

  // 2. è¿½è¸ªæ¯ä¸ªä½œè€…çš„æœ€åæ´»è·ƒæ—¶é—´
  lastActive = max(...comments
    .filter(c => c.author === author)
    .map(c => new Date(c.updatedAt))
  )

  // 3. æ’åºå¹¶å–å‰ 5
  topContributors = Object.entries(authorCounts)
    .sort(([, a], [, b]) => b - a)
    .slice(0, 5)
  ```
- **ä»£ç ä½ç½®**: `parsers/commentsParser.ts:100-120`

#### 4.8 å¹³å‡å“åº”æ—¶é—´ (averageResponseTime)

- **å«ä¹‰**: ä»çˆ¶è¯„è®ºåˆ°ç¬¬ä¸€æ¡å›å¤çš„å¹³å‡æ—¶é—´é—´éš”
- **å•ä½**: å°æ—¶ï¼ˆä¿ç•™ 1 ä½å°æ•°ï¼‰
- **è®¡ç®—å…¬å¼**:
  ```typescript
  // 1. å¯¹æ¯ä¸ªæœ‰å›å¤çš„è¯„è®ºè®¡ç®—å“åº”æ—¶é—´
  responseTime = (firstReply.createdAt - parent.createdAt) / (1000 * 60 * 60)

  // 2. è®¡ç®—å¹³å‡å€¼
  averageResponseTime = sum(responseTimes) / responseTimes.length
  ```
- **è§£è¯»**:
  - < 1 å°æ—¶: å“åº”éå¸¸åŠæ—¶
  - 1-24 å°æ—¶: å“åº”è¾ƒå¿«
  - > 24 å°æ—¶: å“åº”è¾ƒæ…¢ï¼Œå¯èƒ½éœ€è¦æ”¹è¿›æ²Ÿé€š
- **ä»£ç ä½ç½®**: `parsers/commentsParser.ts:122-137`

#### 4.9 æŒ‰æ–‡æ¡£ç»Ÿè®¡ (byDocument)

- **å«ä¹‰**: æ¯ä¸ªæ–‡æ¡£çš„è¯„è®ºæ•°é‡åˆ†å¸ƒ
- **æ•°æ®ç»“æ„**:
  ```typescript
  {
    'spec.md': 15,
    'plan.md': 8,
    'tasks.md': 23
  }
  ```
- **ç”¨é€”**: è¯†åˆ«è®¨è®ºæœ€æ´»è·ƒçš„æ–‡æ¡£
- **ä»£ç ä½ç½®**: `parsers/commentsParser.ts:139-143`

---

## 5. é£é™©æŒ‡æ ‡ (Risk Metrics)

### ğŸ“Š æŒ‡æ ‡è¯´æ˜

é£é™©æŒ‡æ ‡è¯†åˆ«é¡¹ç›®ä¸­çš„æ½œåœ¨é—®é¢˜å’Œé˜»ç¢å› ç´ ï¼Œå¸®åŠ©å›¢é˜Ÿæå‰è§„é¿é£é™©ã€‚

### ğŸ¯ æŒ‡æ ‡åˆ—è¡¨

#### 5.1 é˜»å¡é—®é¢˜åˆ—è¡¨ (blockingIssues)

- **å«ä¹‰**: å¯èƒ½é˜»ç¢é¡¹ç›®è¿›å±•çš„å¼€æ”¾é—®é¢˜
- **æ•°æ®æ¥æº**: è¯„è®ºæ•°æ®
- **è¯†åˆ«æ¡ä»¶**:
  - è¯„è®ºçŠ¶æ€ä¸º 'open'
  - è¯„è®ºå†…å®¹åŒ…å«é˜»å¡å…³é”®è¯
- **å…³é”®è¯**: `['é˜»å¡', 'blocked', 'urgent', 'ç´§æ€¥', 'critical']`
- **æ¯é¡¹åŒ…å«**:
  - `id`: é—®é¢˜å”¯ä¸€æ ‡è¯†ï¼ˆè¯„è®º IDï¼‰
  - `type`: å›ºå®šä¸º `'blocking-issue'`
  - `title`: é—®é¢˜æ ‡é¢˜ï¼ˆè¯„è®ºå†…å®¹å‰ 50 å­—ç¬¦ï¼‰
  - `age`: é—®é¢˜å­˜åœ¨æ—¶é•¿ï¼ˆå¤©æ•°ï¼‰
  - `impact`: å½±å“èŒƒå›´ï¼ˆç®€åŒ–ä¸º 1ï¼‰
  - `source`: æ¥æºæ–‡æ¡£è·¯å¾„
  - `details`: å®Œæ•´è¯„è®ºå†…å®¹
- **æ’åº**: æŒ‰å¹´é¾„é™åºï¼ˆæœ€è€çš„é—®é¢˜æ’æœ€å‰ï¼‰
- **ä»£ç ä½ç½®**: `hooks/useDashboardData.ts:203-224`

#### 5.2 é™ˆæ—§æ–‡æ¡£åˆ—è¡¨ (staleDocuments)

- **å«ä¹‰**: è¶…è¿‡ 30 å¤©æœªæ›´æ–°çš„æ ¸å¿ƒæ–‡æ¡£
- **æ•°æ®æ¥æº**: æ–‡æ¡£æ‰«æç»“æœ
- **è¯†åˆ«æ¡ä»¶**:
  - æ–‡æ¡£å­˜åœ¨
  - æ–‡æ¡£å¤§å° >= 100 å­—èŠ‚
  - è¶…è¿‡ 30 å¤©æœªä¿®æ”¹
- **æ¯é¡¹åŒ…å«**:
  - `id`: æ–‡æ¡£åç§°
  - `type`: å›ºå®šä¸º `'stale-document'`
  - `title`: æ–‡æ¡£åç§°
  - `age`: æœªæ›´æ–°å¤©æ•°
  - `impact`: å½±å“èŒƒå›´ï¼ˆç®€åŒ–ä¸º 1ï¼‰
  - `source`: æ–‡æ¡£å®Œæ•´è·¯å¾„
  - `details`: æè¿°ä¿¡æ¯ï¼ˆ"æ–‡æ¡£å·² X å¤©æœªæ›´æ–°"ï¼‰
- **æ’åº**: æŒ‰å¹´é¾„é™åº
- **ä»£ç ä½ç½®**: `hooks/useDashboardData.ts:226-237`

#### 5.3 å…³é”®è·¯å¾„ (criticalPaths)

- **å«ä¹‰**: é¡¹ç›®ä¸­çš„å…³é”®ä»»åŠ¡é“¾ï¼ˆå½“å‰ä¸ºç®€åŒ–ç‰ˆæœ¬ï¼‰
- **æ•°æ®æ¥æº**: ä»»åŠ¡ç»Ÿè®¡æ•°æ®
- **ç®€åŒ–è®¡ç®—é€»è¾‘**:
  ```typescript
  // å¦‚æœæœ‰é˜»å¡æˆ–è¿›è¡Œä¸­çš„ä»»åŠ¡ï¼Œå½¢æˆå…³é”®è·¯å¾„
  if (blockedTasks > 0 || inProgressTasks > 0) {
    criticalPath = {
      length: blockedTasks + inProgressTasks,
      tasks: [],  // ç®€åŒ–ç‰ˆæœ¬ä¸æä¾›å…·ä½“ä»»åŠ¡
      estimatedDuration: (blockedTasks + inProgressTasks) * 2  // æ¯ä»»åŠ¡ 2 å¤©
    }
  }
  ```
- **æ¯é¡¹åŒ…å«**:
  - `length`: è·¯å¾„åŒ…å«çš„ä»»åŠ¡æ•°é‡
  - `tasks`: ä»»åŠ¡åˆ—è¡¨ï¼ˆç®€åŒ–ç‰ˆæœ¬ä¸ºç©ºï¼‰
  - `estimatedDuration`: é¢„è®¡å®Œæˆå¤©æ•°
- **æœªæ¥æ‰©å±•**: å¯åŸºäºä»»åŠ¡ä¾èµ–å…³ç³»åˆ†æçœŸå®å…³é”®è·¯å¾„
- **ä»£ç ä½ç½®**: `hooks/useDashboardData.ts:239-248`

---

## ğŸ”„ æ•°æ®æµç¨‹å’Œé›†æˆ

### æ•°æ®åŠ è½½æµç¨‹

```typescript
// 1. åˆå§‹åŒ–åŠ è½½
useDashboardData(featureId)
  â”œâ”€> æ£€æŸ¥ç¼“å­˜ï¼ˆ5åˆ†é’Ÿ TTLï¼‰
  â”‚   â””â”€> å¦‚æœç¼“å­˜æœ‰æ•ˆï¼Œç›´æ¥è¿”å›
  â”‚
  â”œâ”€> å¹¶è¡Œè¯»å–æ–‡ä»¶
  â”‚   â”œâ”€> CLIService.readDocument('tasks.md')
  â”‚   â”œâ”€> CLIService.readDocument('spec.md')
  â”‚   â”œâ”€> CLIService.listDocuments('specs/[id]/')
  â”‚   â””â”€> CLIService.listComments('[id]/')
  â”‚
  â”œâ”€> è§£ææ•°æ®
  â”‚   â”œâ”€> parseTasksFile(tasksContent)
  â”‚   â”œâ”€> parseSpecFile(specContent)
  â”‚   â”œâ”€> parseCommentsData(commentsArray)
  â”‚   â””â”€> calculateDocumentMetrics(docStats)
  â”‚
  â”œâ”€> èšåˆæŒ‡æ ‡
  â”‚   â”œâ”€> è®¡ç®—è¿›åº¦ç™¾åˆ†æ¯”
  â”‚   â”œâ”€> æŒ‰ä¼˜å…ˆçº§åˆ†ç»„ç”¨æˆ·æ•…äº‹
  â”‚   â”œâ”€> è®¡ç®—éªŒæ”¶åœºæ™¯é€šè¿‡ç‡
  â”‚   â”œâ”€> è¯†åˆ«é˜»å¡é—®é¢˜å’Œé™ˆæ—§æ–‡æ¡£
  â”‚   â””â”€> ç»„è£… FeatureDashboardMetrics
  â”‚
  â””â”€> æ›´æ–°çŠ¶æ€å’Œç¼“å­˜
      â”œâ”€> setMetrics(metrics)
      â””â”€> setCache(featureId, metrics, ttl: 5åˆ†é’Ÿ)
```

### ç¼“å­˜æœºåˆ¶

- **ç¼“å­˜é”®**: `dashboard-${featureId}`
- **TTL**: 5 åˆ†é’Ÿï¼ˆ300,000 æ¯«ç§’ï¼‰
- **ç¼“å­˜ä½ç½®**: Zustand store (dashboardStore)
- **å¤±æ•ˆæ¡ä»¶**:
  - è¶…è¿‡ 5 åˆ†é’Ÿ
  - æ‰‹åŠ¨è°ƒç”¨ `reload()`
  - æ–‡æ¡£å†…å®¹å˜æ›´ï¼ˆé€šè¿‡ CLI æœåŠ¡é€šçŸ¥ï¼‰

### é”™è¯¯å¤„ç†

```typescript
try {
  // æ•°æ®åŠ è½½é€»è¾‘
} catch (err) {
  setError(err instanceof Error ? err.message : 'åŠ è½½æ•°æ®å¤±è´¥')
} finally {
  setLoading(false)
}
```

---

## ğŸ“– ä½¿ç”¨æŒ‡å—

### å¦‚ä½•è¯»æ‡‚æŒ‡æ ‡

#### 1. é¡¹ç›®å¥åº·åº¦åˆ¤æ–­

**è‰¯å¥½çŠ¶æ€**:
- è¿›åº¦ç™¾åˆ†æ¯” > 50%
- æ–‡æ¡£è¦†ç›–ç‡ = 100%
- æ‰€æœ‰æ–‡æ¡£çŠ¶æ€ä¸º 'ok'
- æœªè§£å†³é—®é¢˜ < 5
- é˜»å¡é—®é¢˜ = 0

**éœ€è¦å…³æ³¨**:
- è¿›åº¦ç™¾åˆ†æ¯” < 30% ä¸”å­˜åœ¨è¶…è¿‡ 30 å¤©
- æ–‡æ¡£è¦†ç›–ç‡ < 80%
- å­˜åœ¨ 'stale' çŠ¶æ€æ–‡æ¡£
- æœªè§£å†³é—®é¢˜ > 10
- é˜»å¡é—®é¢˜ > 0

**é«˜é£é™©çŠ¶æ€**:
- è¿›åº¦ç™¾åˆ†æ¯”é•¿æœŸåœæ»
- å…³é”®æ–‡æ¡£ï¼ˆspec.md, tasks.mdï¼‰ç¼ºå¤±
- å¤šä¸ªé˜»å¡é—®é¢˜ä¸”å¹´é¾„ > 7 å¤©
- å‘¨è¯„è®ºå¢é•¿ç‡æŒç»­ä¸ºè´Ÿ

#### 2. å›¢é˜Ÿåä½œå¥åº·åº¦

**æ´»è·ƒå›¢é˜Ÿ**:
- å‚ä¸äººæ•° >= 3
- æœ¬å‘¨æ–°å¢è¯„è®º > 5
- å¹³å‡å“åº”æ—¶é—´ < 24 å°æ—¶
- å‘¨å¢é•¿ç‡ > 0

**éœ€è¦æ¿€æ´»**:
- å‚ä¸äººæ•° < 2
- æœ¬å‘¨æ–°å¢è¯„è®º = 0
- å¹³å‡å“åº”æ—¶é—´ > 48 å°æ—¶

#### 3. é£é™©è¯†åˆ«

**ç«‹å³å¤„ç†**:
- é˜»å¡é—®é¢˜å¹´é¾„ > 3 å¤©
- å…³é”®æ–‡æ¡£ï¼ˆspec.md, tasks.mdï¼‰é™ˆæ—§
- å…³é”®è·¯å¾„é¢„è®¡æ—¶é•¿ > é¡¹ç›®å‰©ä½™æ—¶é—´

**è®¡åˆ’å¤„ç†**:
- éå…³é”®æ–‡æ¡£é™ˆæ—§
- æœªè§£å†³é—®é¢˜å †ç§¯ï¼ˆä½†æ— é˜»å¡ï¼‰

### å¸¸è§é—®é¢˜

#### Q: ä¸ºä»€ä¹ˆæ–‡æ¡£è¦†ç›–ç‡ä¸æ˜¯ 100%ï¼Ÿ

**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. æ ¸å¿ƒæ–‡æ¡£æ˜¯å¦éƒ½å·²åˆ›å»º
2. æ–‡ä»¶å¤§å°æ˜¯å¦ >= 100 å­—èŠ‚ï¼ˆé¿å…ç©ºæ–‡ä»¶ï¼‰
3. æ–‡ä»¶æ˜¯å¦åœ¨æ­£ç¡®çš„ç›®å½• `specs/[feature-id]/`

#### Q: ä¸ºä»€ä¹ˆè¯„è®ºæ•°æ˜¾ç¤ºä¸º 0ï¼Ÿ

**A**: å¯èƒ½åŸå› ï¼š
1. è¯„è®ºæ–‡ä»¶è·¯å¾„ä¸æ­£ç¡®ï¼ˆåº”åœ¨ `.specify/memory/comments/[feature-id]/`ï¼‰
2. è¯„è®º JSON æ ¼å¼ä¸æ­£ç¡®
3. ç‰¹æ€§ ID ä¸åŒ¹é…

#### Q: å¦‚ä½•æ ‡è®°ä»»åŠ¡ä¸ºé˜»å¡ï¼Ÿ

**A**: å½“å‰å®ç°ä¸­ï¼Œé˜»å¡ä»»åŠ¡éœ€è¦é€šè¿‡è¯„è®ºç³»ç»Ÿæ ‡è®°ï¼š
1. åœ¨ç›¸å…³æ–‡æ¡£ä½ç½®æ·»åŠ è¯„è®º
2. è¯„è®ºå†…å®¹åŒ…å«é˜»å¡å…³é”®è¯ï¼ˆé˜»å¡ã€blockedã€urgent ç­‰ï¼‰
3. è¯„è®ºçŠ¶æ€ä¿æŒä¸º 'open'

#### Q: éªŒæ”¶åœºæ™¯é€šè¿‡ç‡å¦‚ä½•å‡†ç¡®è®¡ç®—ï¼Ÿ

**A**: å½“å‰ä¸ºç®€åŒ–é€»è¾‘ï¼ˆç”¨æˆ·æ•…äº‹å®Œæˆ = æ‰€æœ‰åœºæ™¯é€šè¿‡ï¼‰ã€‚æœªæ¥å¯é›†æˆï¼š
- æµ‹è¯•æ¡†æ¶ç»“æœ
- æ‰‹åŠ¨æ ‡è®°åœºæ™¯çŠ¶æ€
- CI/CD æµ‹è¯•æŠ¥å‘Š

---

## ğŸ”® æœªæ¥æ‰©å±•

### è®¡åˆ’å¢å¼ºåŠŸèƒ½

1. **ä»»åŠ¡ä¾èµ–åˆ†æ**:
   - è§£æä»»åŠ¡é—´çš„ä¾èµ–å…³ç³»
   - è®¡ç®—çœŸå®å…³é”®è·¯å¾„
   - è¯†åˆ«ä¾èµ–é˜»å¡

2. **æ›´ç²¾ç¡®çš„è¿›åº¦é¢„æµ‹**:
   - åŸºäºå†å²é€Ÿåº¦é¢„æµ‹å®Œæˆæ—¶é—´
   - è€ƒè™‘é˜»å¡å› ç´ å½±å“
   - ç”Ÿæˆç‡ƒå°½å›¾æ•°æ®

3. **æ–‡æ¡£è´¨é‡è¯„åˆ†**:
   - å†…å®¹å®Œæ•´åº¦æ£€æŸ¥
   - æ ¼å¼è§„èŒƒæ€§éªŒè¯
   - å…³é”®ç« èŠ‚ç¼ºå¤±æ£€æµ‹

4. **åä½œæ¨¡å¼åˆ†æ**:
   - è¯†åˆ«æ´»è·ƒæ—¶æ®µ
   - è´¡çŒ®è€…ç½‘ç»œå›¾
   - å“åº”æ—¶é—´è¶‹åŠ¿

5. **é£é™©é¢„è­¦ç³»ç»Ÿ**:
   - è‡ªåŠ¨è¯†åˆ«æ½œåœ¨é£é™©
   - å‘é€é€šçŸ¥æé†’
   - é£é™©ç­‰çº§é‡åŒ–

---

## ğŸ“ ç›¸å…³èµ„æº

- [Feature Dashboard ç”¨æˆ·æŒ‡å—](../README.md#ç»Ÿè®¡é¢æ¿) - åŠŸèƒ½ä½¿ç”¨è¯´æ˜
- [æ•°æ®æ¨¡å‹å®šä¹‰](../dashboard/src/pages/FeatureDashboard/types/metrics.ts) - TypeScript ç±»å‹
- [è§£æå™¨å®ç°](../dashboard/src/pages/FeatureDashboard/services/parsers/) - æºä»£ç 
- [æŒ‡æ ‡è®¡ç®—é€»è¾‘](../dashboard/src/pages/FeatureDashboard/services/metrics/) - è®¡ç®—å‡½æ•°

---

**æœ€åæ›´æ–°**: 2025-11-28
**ç‰ˆæœ¬**: 1.0.0
**ç»´æŠ¤è€…**: Speckit Enhancer Team
